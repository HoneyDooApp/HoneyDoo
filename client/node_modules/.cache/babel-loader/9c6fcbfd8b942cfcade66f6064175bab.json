{"ast":null,"code":"var _jsxFileName = \"/Users/codex/Desktop/bootcamp/Bootcamp_coding/HoneyDoo/client/src/pages/Login.js\";\nimport React, { useEffect, useRef } from \"react\";\nimport { Redirect, Link } from \"react-router-dom\";\nimport { useStoreContext } from \"../utils/GlobalStore\";\nimport fetchJSON from \"../utils/API\";\n\nfunction Login() {\n  const [{\n    authOk\n  }, dispatch] = useStoreContext();\n  const inputEmail = useRef();\n  const inputPassword = useRef();\n  const inputRememberMe = useRef();\n  const refForm = useRef();\n\n  async function userLogin(e) {\n    e.preventDefault();\n    console.log(`[userLogin]`); // leverage browser built in + bootstrap features for form validation\n\n    if (!refForm.current.checkValidity()) {\n      refForm.current.classList.add('was-validated');\n      return;\n    }\n\n    const saveData = {\n      email: inputEmail.current.value,\n      password: inputPassword.current.value,\n      rememberMe: inputRememberMe.current.checked\n    };\n\n    if (saveData.email.indexOf('@') < 3 || saveData.password.length < 8) {\n      inputEmail.current.focus();\n      dispatch({\n        type: 'ALERT_MESSAGE',\n        message: 'Something is wrong with your login.'\n      });\n      return;\n    }\n\n    const {\n      status,\n      session,\n      userData,\n      message\n    } = await fetchJSON('/api/users/login', 'post', saveData);\n\n    if (!status) {\n      // clear any session\n      localStorage.session = '';\n      dispatch({\n        type: 'ALERT_MESSAGE',\n        message\n      });\n      return;\n    } // remember email if user wanted\n\n\n    if (inputRememberMe && inputRememberMe.current.checked) {\n      localStorage.email = inputEmail.current.value;\n    } else {\n      localStorage.email = '';\n    } // login ok, saving session & saving userData\n\n\n    localStorage.session = session;\n    dispatch({\n      type: 'USER_LOGIN',\n      data: userData\n    });\n  } // at startup we initialize a few things\n\n\n  useEffect(function () {\n    inputEmail.current.value = localStorage.email || '';\n    inputRememberMe.current.checked = true;\n  }, []);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, authOk ? /*#__PURE__*/React.createElement(Redirect, {\n    to: \"/tasks\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 24\n    }\n  }) : '', /*#__PURE__*/React.createElement(\"form\", {\n    ref: refForm,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    class: \"card mt-5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    class: \"card-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 21\n    }\n  }, \"Login\")), /*#__PURE__*/React.createElement(\"div\", {\n    class: \"card-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    class: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    for: \"email\",\n    class: \"form-label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 25\n    }\n  }, \"Email address\"), /*#__PURE__*/React.createElement(\"input\", {\n    ref: inputEmail,\n    id: \"email\",\n    type: \"email\",\n    class: \"form-control\",\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    class: \"invalid-feedback\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 25\n    }\n  }, \"Please enter your login email\")), /*#__PURE__*/React.createElement(\"div\", {\n    class: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    for: \"userPassword\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 25\n    }\n  }, \"Password\"), /*#__PURE__*/React.createElement(\"input\", {\n    ref: inputPassword,\n    id: \"userPassword\",\n    type: \"password\",\n    class: \"form-control\",\n    pattern: \".{8,}\",\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    class: \"invalid-feedback\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 25\n    }\n  }, \"Please enter your password (8 chars min)\"))), /*#__PURE__*/React.createElement(\"div\", {\n    class: \"card-footer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: userLogin,\n    type: \"button\",\n    class: \"btn btn-primary mx-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 21\n    }\n  }, \"Login\"), \"\\xA0\", /*#__PURE__*/React.createElement(\"input\", {\n    ref: inputRememberMe,\n    id: \"rememberMe\",\n    type: \"checkbox\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    class: \"text-secondary\",\n    for: \"rememberMe\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 21\n    }\n  }, \"Remember Me\"), \" \\xA0\", /*#__PURE__*/React.createElement(Link, {\n    to: \"/register\",\n    class: \"mx-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 21\n    }\n  }, \"Need to Register?\")))));\n}\n\nexport default Login;","map":{"version":3,"sources":["/Users/codex/Desktop/bootcamp/Bootcamp_coding/HoneyDoo/client/src/pages/Login.js"],"names":["React","useEffect","useRef","Redirect","Link","useStoreContext","fetchJSON","Login","authOk","dispatch","inputEmail","inputPassword","inputRememberMe","refForm","userLogin","e","preventDefault","console","log","current","checkValidity","classList","add","saveData","email","value","password","rememberMe","checked","indexOf","length","focus","type","message","status","session","userData","localStorage","data"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef } from \"react\"\nimport { Redirect, Link } from \"react-router-dom\"\nimport { useStoreContext } from \"../utils/GlobalStore\"\nimport fetchJSON from \"../utils/API\"\n\nfunction Login(){\n    const [{ authOk }, dispatch ]= useStoreContext()\n\n    const inputEmail = useRef()\n    const inputPassword = useRef()\n    const inputRememberMe = useRef()\n    const refForm = useRef()\n\n    async function userLogin( e ){\n        e.preventDefault()\n        console.log( `[userLogin]` )\n        \n        // leverage browser built in + bootstrap features for form validation\n        if( !refForm.current.checkValidity() ){            \n            refForm.current.classList.add('was-validated')\n            return\n        }\n\n        const saveData = {\n            email: inputEmail.current.value,\n            password: inputPassword.current.value,\n            rememberMe: inputRememberMe.current.checked\n        }\n\n        if( saveData.email.indexOf('@')<3 || saveData.password.length<8 ) {\n            inputEmail.current.focus()\n            dispatch({ type: 'ALERT_MESSAGE', message: 'Something is wrong with your login.' })\n            return\n        }\n    \n        const { status, session, userData, message }= await fetchJSON( '/api/users/login', 'post', saveData )            \n        if( !status ){\n            // clear any session\n            localStorage.session = ''\n            dispatch({ type: 'ALERT_MESSAGE', message })\n            return\n        }\n\n        // remember email if user wanted\n        if( inputRememberMe && inputRememberMe.current.checked ){\n            localStorage.email = inputEmail.current.value\n        } else {\n            localStorage.email = ''\n        }\n         \n        // login ok, saving session & saving userData\n        localStorage.session = session\n        dispatch({ type: 'USER_LOGIN', data: userData })\n    }\n\n    // at startup we initialize a few things\n    useEffect( function(){\n        inputEmail.current.value = localStorage.email || ''\n        inputRememberMe.current.checked = true\n    }, [] )\n\n    return (\n        <>\n            { authOk ? <Redirect to='/tasks' /> : '' }\n            <form ref={refForm}>\n            <div class=\"card mt-5\">\n                <div class=\"card-header\">\n                    <h1>Login</h1>\n                </div>\n                <div class=\"card-body\">\n                    <div class=\"mb-3\">\n                        <label for=\"email\" class=\"form-label\">Email address</label>\n                        <input ref={inputEmail} id=\"email\" type=\"email\" class=\"form-control\" required />\n                        <div class=\"invalid-feedback\">\n                            Please enter your login email\n                        </div>\n                    </div>\n                    <div class=\"mb-3\">\n                        <label for=\"userPassword\">Password</label>\n                        <input ref={inputPassword} id=\"userPassword\" type=\"password\" class=\"form-control\"  pattern=\".{8,}\" required />\n                        <div class=\"invalid-feedback\">\n                            Please enter your password (8 chars min)\n                        </div>\n                    </div>\n                </div>                    \n                <div class=\"card-footer\">\n                    <button onClick={userLogin} type=\"button\" class=\"btn btn-primary mx-1\">Login</button>\n                    &nbsp; \n                    <input ref={inputRememberMe} id='rememberMe' type=\"checkbox\" />                        \n                    <label class='text-secondary' for='rememberMe'>Remember Me</label> &nbsp;\n                    <Link to=\"/register\" class=\"mx-3\">Need to Register?</Link>\n                </div>\n            </div>\n            </form>\n        </>\n    )\n}\n\nexport default Login"]},"metadata":{},"sourceType":"module"}